
<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ã‚¯ãƒ©ã‚¹é€£çµ¡ï¼‹ç”»å»ŠSHION</title>
<style>
/* ======== ãƒ‘ã‚¹ãƒ†ãƒ«ãƒ‡ã‚¶ã‚¤ãƒ³éƒ¨åˆ† ======== */
body {
  box-sizing: border-box;
  font-family: 'Hiragino Sans', 'Yu Gothic', sans-serif;
  margin: 0;
  padding: 20px;
  background: linear-gradient(135deg, #f3e7ff, #e3fdfd);
  color: #333;
}
.container {
  max-width: 900px;
  margin: 0 auto;
  background: white;
  border-radius: 20px;
  box-shadow: 0 6px 25px rgba(0,0,0,0.1);
  overflow: hidden;
  padding-bottom: 30px;
}
.header {
  background-color: #ffd6e0;
  color: #444;
  padding: 30px 20px;
  text-align: center;
  border-bottom: 3px solid #ffe7f1;
}
.header h1 {
  margin: 0;
  font-size: 26px;
  font-weight: 700;
}
.bible-text {
  font-size: 16px;
  margin-top: 6px;
  color: #666;
}
.main-content {
  display: flex;
  flex-wrap: wrap;
}
.date-buttons {
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  flex: 1;
  min-width: 260px;
  border-right: 2px solid #eaeaea;
}
.button-row {
  display: flex;
  gap: 8px;
}
button {
  border: none;
  border-radius: 12px;
  padding: 14px 0;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.25s ease;
  flex: 1;
}
.omikuji-button {
  background-color: #fff9b1;
  color: #333;
  box-shadow: 0 4px 10px rgba(255, 249, 177, 0.4);
}
.omikuji-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 14px rgba(255, 249, 177, 0.5);
}
.date-button {
  background-color: #cce5ff;
  color: #333;
  box-shadow: 0 3px 10px rgba(204, 229, 255, 0.4);
}
.date-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(204, 229, 255, 0.5);
}
.omikuji-result {
  margin-top: 8px;
  padding: 12px;
  background-color: #fff8dc;
  border-left: 4px solid #ffd580;
  border-radius: 8px;
  font-size: 14px;
  text-align: center;
  display: none;
}
.schedule-display {
  flex: 1;
  margin: 20px;
  padding: 20px;
  background-color: #ede7f6;
  border-radius: 15px;
  border-left: 5px solid #b39ddb;
  display: none;
}
.schedule-display.show { display: block; }
.change-item {
  margin: 8px 0;
  padding: 8px 12px;
  background: #fff;
  border-radius: 8px;
  border-left: 3px solid #b39ddb;
}

/* ======== ã‚®ãƒ£ãƒ©ãƒªãƒ¼éƒ¨åˆ†ï¼ˆã‚ãªãŸã®ãƒ‡ã‚¶ã‚¤ãƒ³ï¼‰ ======== */
.uploader {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  align-items: center;
  margin: 20px;
}
#gallery {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 12px;
  margin: 20px;
}
.card {
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 8px;
  background: white;
  position: relative;
  transition: transform 0.2s;
}
.card:hover { transform: scale(1.05); }
.card img {
  width: 100%;
  height: 140px;
  object-fit: cover;
  border-radius: 6px;
}
.meta {
  font-size: 12px;
  color: #555;
  margin-top: 6px;
  white-space: pre-line;
}
.delete-btn {
  position: absolute;
  top: 6px;
  right: 6px;
  background: red;
  color: white;
  border: none;
  border-radius: 4px;
  padding: 2px 6px;
  font-size: 12px;
  cursor: pointer;
}
#modal {
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.8);
  justify-content: center;
  align-items: center;
  z-index: 9999;
}
#modal img {
  max-width: 90%;
  max-height: 90%;
  border-radius: 10px;
}
#status {
  font-size: 13px;
  color: #333;
  margin-top: 5px;
}
</style>
</head>

<body>
<main class="container">
  <header class="header">
    <h1>11æœˆ14æ—¥ï¼ˆé‡‘ï¼‰</h1>
    <div class="bible-text">Peace Truth LOVE</div>
  </header>

  <div class="main-content">
    <section class="date-buttons">
      <div class="button-row">
        <button class="omikuji-button" onclick="drawOmikuji()">ãŠã¿ãã˜ 1æ—¥2å›ã¾ã§</button>
      </div>
      <div id="omikujiResult" class="omikuji-result"></div>

      <div class="button-row">
        <button class="date-button" onclick="showSchedule('today')">æœ¬æ—¥</button>
        <button class="date-button" onclick="showSchedule('tomorrow')">æ˜æ—¥</button>
        <button class="date-button" onclick="showSchedule('following')">æ˜å¾Œæ—¥</button>
      </div>
    </section>

    <div id="scheduleDisplay" class="schedule-display">
      <div id="scheduleDate" class="schedule-date"></div>
      <div id="scheduleContent" class="schedule-content"></div>
    </div>
  </div>

  <!-- ==== å†™çœŸã‚®ãƒ£ãƒ©ãƒªãƒ¼ ==== -->
  <section>
    <h2 style="text-align:center; color:#555;">ğŸ“· ç”»å»Š SHION</h2>
    <div id="gallery"></div>
  </section>

  <section class="uploader">
    <label>æŠ•ç¨¿è€…åï¼ˆå¿…é ˆï¼‰<br><input id="username" type="text"></label>
    <label>ç”»åƒã‚’é¸æŠ<br><input id="fileInput" type="file" accept="image/*"></label>
    <button id="uploadBtn">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</button>
    <div id="status"></div>
  </section>

  <div id="modal"><img id="modalImg" src=""></div>
</main>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>

<script>
// ===== ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ»ãŠã¿ãã˜ =====
const scheduleData = {
  'today': { date: 'æœ¬æ—¥', content: '<div class="change-item">è¶£å‘³ã¯å‹‰å¼·ã€ç‰¹æŠ€ã¯ãƒ†ã‚¹ãƒˆ</div>' },
  'tomorrow': { date: 'æ˜æ—¥', content: '<div class="change-item">è©¦é¨“ç›´å‰ã®åœŸæ›œæ—¥ã‚’æœ‰åŠ¹æ´»ç”¨</div>' },
  'following': { date: 'æ˜å¾Œæ—¥', content: '<div class="change-item">è©¦é¨“ç›´å‰ã®æ—¥æ›œæ—¥ã‚’æœ‰åŠ¹æ´»ç”¨</div>' }
};
const omikujiResults = [
  {name:'å‡¶',text:'éš•çŸ³ãŒã¶ã¤ã‹ã‚‹'},
  {name:'å‰',text:'å¸¸åŒ—ãƒ•ã‚¡ãƒ¼ãƒ ã§æ„›ã®ã•ã•ã‚„ã'},
  {name:'æœ«å‰',text:'è„³ç­‹å¤§çˆ†ç™ºï¼'},
  {name:'å°å‰',text:'è„³ã¿ãçµ¶å¯¾é›¶åº¦'},
  {name:'ä¸­å‰',text:'å®‡ä½ç¾ã‚’ç‹¬ã‚Šå ã‚'},
  {name:'å¤§å‰',text:'è©è°·ã¨ç¨ã‚ã£ã“'}
];
function drawOmikuji(){
  const today = new Date().toDateString();
  const saved = localStorage.getItem('omikuji') ? JSON.parse(localStorage.getItem('omikuji')) : {};
  const count = saved[today]?.count || 0;
  const resultBox = document.getElementById('omikujiResult');
  resultBox.style.display = 'block';
  if(count >= 2){
    resultBox.innerHTML = `ä»Šæ—¥ã®é‹å‹¢ï¼š<strong>${saved[today].result.name}</strong><br>${saved[today].result.text}`;
    return;
  }
  const r = omikujiResults[Math.floor(Math.random()*omikujiResults.length)];
  saved[today] = { result: r, count: count+1 };
  localStorage.setItem('omikuji', JSON.stringify(saved));
  resultBox.innerHTML = `ä»Šæ—¥ã®é‹å‹¢ï¼š<strong>${r.name}</strong><br>${r.text}`;
}
function showSchedule(key){
  const d=document.getElementById('scheduleDisplay');
  document.getElementById('scheduleDate').textContent=scheduleData[key].date;
  document.getElementById('scheduleContent').innerHTML=scheduleData[key].content;
  d.classList.add('show');
}


// ===== Firebaseï¼ˆã‚ãªãŸã®è¨­å®šï¼‰ =====
const firebaseConfig = {
  apiKey: "AIzaSyBSZkU6GaWz2stkLKjcCJEm_8uEhMEG98s",
  authDomain: "shion-b9c2a.firebaseapp.com",
  projectId: "shion-b9c2a",
  storageBucket: "shion-b9c2a.appspot.com",
  messagingSenderId: "236221572207",
  appId: "1:236221572207:web:ee9e5b510fbbc3722c999a"
};

firebase.initializeApp(firebaseConfig);
const storage = firebase.storage();
const db = firebase.firestore(); // âœ… ã“ã‚Œã‚’è¿½åŠ ï¼



const usernameInput=document.getElementById("username");
const fileInput=document.getElementById("fileInput");
const uploadBtn=document.getElementById("uploadBtn");
const status=document.getElementById("status");
const gallery=document.getElementById("gallery");
const modal=document.getElementById("modal");
const modalImg=document.getElementById("modalImg");

// ===== ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç† =====
uploadBtn.addEventListener("click", async ()=>{
  const name=usernameInput.value.trim();
  const file=fileInput.files[0];
  if(!name){status.textContent="æŠ•ç¨¿è€…åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚";return;}
  if(!file){status.textContent="ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚";return;}
  uploadBtn.disabled=true;status.textContent="ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...";
  try{
    const ref=storage.ref("test-images/"+name+".jpg");
    await ref.put(file);
    const url=await ref.getDownloadURL();
    await db.collection("test-images").doc(name).set({username:name,url:url,updatedAt:new Date()});
    status.textContent="ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†ï¼";
    fileInput.value="";
  }catch(e){console.error(e);status.textContent="ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—ã€‚";}
  finally{uploadBtn.disabled=false;}
});

// ===== ã‚®ãƒ£ãƒ©ãƒªãƒ¼è¡¨ç¤º =====
db.collection("test-images").onSnapshot(snapshot=>{
  gallery.innerHTML="";
  snapshot.forEach(doc=>{
    const data=doc.data();
    const div=document.createElement("div");
    div.className="card";
    const img=document.createElement("img");
    img.src=data.url;
    const meta=document.createElement("div");
    meta.className="meta";
    meta.textContent=`${data.username}\n${new Date(data.updatedAt.seconds*1000).toLocaleString()}`;
    div.appendChild(img);
    div.appendChild(meta);
    img.addEventListener("click",()=>{
      modalImg.src=data.url;
      modal.style.display="flex";
    });
    gallery.appendChild(div);
  });
});
modal.addEventListener("click",()=>{
  modal.style.display="none";
  modalImg.src="";
});
</script>
</body>
</html>
